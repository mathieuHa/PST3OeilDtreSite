{% extends "DTREOeilSiteBundle::layout.html.twig" %}

{% block title %}
    {{ parent() }}
{% endblock %}

{% block bundle_body %}
    <div class="page-header">
        <h1>Accueil</h1>
    </div>

    {% for key, messages in app.session.flashbag.all() %}
        {% for message in messages %}
            <div class="alert alert-{{ key }}">
                {{ message|trans({}, 'FOSUserBundle') }}
            </div>
        {% endfor %}
    {% endfor %}
    <p><input type="button" value="Embêter le serveur" id="poke" /></p>
    <img id="img">


    <script src="{{ asset('192.168.1.27:8080/socket.io/socket.io.js') }}"></script>

    <script>
        var socket = io.connect('http://localhost:8080');
        socket.on('message', function(message) {
            alert('Le serveur a un message pour vous : ' + message);
        })

        $('#poke').click(function () {
            socket.emit('message', 'Salut serveur, ça va ?');
        })
    </script>
    <script>
        var img = document.getElementById('img'),
            socket = io('');
        socket.on('data', function(data) {
            img.src = 'data:image/jpeg;base64,' + data;
        });
    </script>

{% endblock %}



{% block bundle_javascript %}
    {{ parent() }}
{% endblock %}